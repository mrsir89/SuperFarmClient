{"ast":null,"code":"import _defineProperty from \"D:\\\\Project\\\\SuperFarmClientTemp\\\\SuperFarmClient\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n// 인터셉터 정의\n// 인터셉터는 여러개 만들수 있다.\n\n/*\n    현재 만드는 인터셉터는 request 할때의 interceptor이다.\n    req = xmlhttprequest  javaScript에서 ajax headere를 가지고 있다.\n*/\n//                            [리덕스함수] [xmlhttprequest] -> header를 갖고있다.\nconst requestInterceptor = ({\n  getState\n}, req) => {\n  const _getState = getState(),\n        auth = _getState.auth;\n\n  const token = auth.token;\n  let headers = req.headers,\n      url = req.url;\n\n  if (token !== undefined && token !== null && url !== '/oauth/token') {\n    const access_token = token.access_token;\n\n    if (access_token !== undefined && access_token !== null) {\n      // 여기서 토큰을 갱신해도 안전함.\n      headers = _objectSpread({}, headers, {\n        'Authorization': \"Bearer \".concat(access_token)\n      });\n    }\n  }\n\n  console.log('requestInterceptor  headers', headers);\n  console.log('requestInterceptor  ...req ', req);\n  return _objectSpread({}, req, {\n    headers\n  });\n}; // 리턴.  request 도 있고 response도 있음.\n\n\nconst interceptors = {\n  request: [requestInterceptor]\n};\nexport default interceptors; // 토큰을 받는 시점에 토큰을 받은 시간(현재시간 타임스탬프)을 저장한다.\n// 토큰을 받은 시간(approvedTime+expires_in)과 현재시간을 비교하여 현재시간이 더 크면 토큰 소멸\n// 리프레시 토큰 리트라이에서 실패해도 갱신 가능.","map":{"version":3,"sources":["D:\\Project\\SuperFarmClientTemp\\SuperFarmClient\\src\\util\\interceptors.js"],"names":["requestInterceptor","getState","req","auth","token","headers","url","undefined","access_token","console","log","interceptors","request"],"mappings":";;;;;;AAAA;AACA;;AACA;;;;AAIA;AACA,MAAMA,kBAAkB,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,EAAeC,GAAf,KAAuB;AAAA,oBAC7BD,QAAQ,EADqB;AAAA,QACtCE,IADsC,aACtCA,IADsC;;AAAA,QAEtCC,KAFsC,GAE5BD,IAF4B,CAEtCC,KAFsC;AAAA,MAGxCC,OAHwC,GAGvBH,GAHuB,CAGxCG,OAHwC;AAAA,MAG/BC,GAH+B,GAGvBJ,GAHuB,CAG/BI,GAH+B;;AAM9C,MAAIF,KAAK,KAAKG,SAAV,IAAuBH,KAAK,KAAK,IAAjC,IAAyCE,GAAG,KAAK,cAArD,EAAqE;AAAA,UACzDE,YADyD,GACxCJ,KADwC,CACzDI,YADyD;;AAGjE,QAAIA,YAAY,KAAKD,SAAjB,IAA8BC,YAAY,KAAK,IAAnD,EAAyD;AACrD;AACAH,MAAAA,OAAO,qBAAQA,OAAR;AAAiB,0CAA2BG,YAA3B;AAAjB,QAAP;AACH;AACJ;;AACDC,EAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2CL,OAA3C;AACAI,EAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2CR,GAA3C;AACA,2BAAYA,GAAZ;AAAiBG,IAAAA;AAAjB;AACH,CAjBD,C,CAmBA;;;AACA,MAAMM,YAAY,GAAG;AACjBC,EAAAA,OAAO,EAAE,CACLZ,kBADK;AADQ,CAArB;AAMA,eAAeW,YAAf,C,CACA;AACA;AACA","sourcesContent":["// 인터셉터 정의\n// 인터셉터는 여러개 만들수 있다.\n/*\n    현재 만드는 인터셉터는 request 할때의 interceptor이다.\n    req = xmlhttprequest  javaScript에서 ajax headere를 가지고 있다.\n*/\n//                            [리덕스함수] [xmlhttprequest] -> header를 갖고있다.\nconst requestInterceptor = ({ getState }, req) => {\n    const { auth } = getState();\n    const { token } = auth;\n    let { headers, url } = req;\n\n\n    if (token !== undefined && token !== null && url !== '/oauth/token') {\n        const { access_token } = token;\n\n        if (access_token !== undefined && access_token !== null) {\n            // 여기서 토큰을 갱신해도 안전함.\n            headers = { ...headers, 'Authorization': `Bearer ${access_token}` };\n        }\n    }\n    console.log('requestInterceptor  headers', headers)\n    console.log('requestInterceptor  ...req ', req)\n    return { ...req, headers }\n};\n\n// 리턴.  request 도 있고 response도 있음.\nconst interceptors = {\n    request: [\n        requestInterceptor\n    ]\n};\n\nexport default interceptors;\n// 토큰을 받는 시점에 토큰을 받은 시간(현재시간 타임스탬프)을 저장한다.\n// 토큰을 받은 시간(approvedTime+expires_in)과 현재시간을 비교하여 현재시간이 더 크면 토큰 소멸\n// 리프레시 토큰 리트라이에서 실패해도 갱신 가능."]},"metadata":{},"sourceType":"module"}