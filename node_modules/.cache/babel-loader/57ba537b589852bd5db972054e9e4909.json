{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nclass HookMap {\n  constructor(factory) {\n    this._map = new Map();\n    this._factory = factory;\n    this._interceptors = [];\n  }\n\n  get(key) {\n    return this._map.get(key);\n  }\n\n  for(key) {\n    const hook = this.get(key);\n\n    if (hook !== undefined) {\n      return hook;\n    }\n\n    let newHook = this._factory(key);\n\n    const interceptors = this._interceptors;\n\n    for (let i = 0; i < interceptors.length; i++) {\n      newHook = interceptors[i].factory(key, newHook);\n    }\n\n    this._map.set(key, newHook);\n\n    return newHook;\n  }\n\n  intercept(interceptor) {\n    this._interceptors.push(Object.assign({\n      factory: (key, hook) => hook\n    }, interceptor));\n  }\n\n  tap(key, options, fn) {\n    return this.for(key).tap(options, fn);\n  }\n\n  tapAsync(key, options, fn) {\n    return this.for(key).tapAsync(options, fn);\n  }\n\n  tapPromise(key, options, fn) {\n    return this.for(key).tapPromise(options, fn);\n  }\n\n}\n\nmodule.exports = HookMap;","map":null,"metadata":{},"sourceType":"script"}